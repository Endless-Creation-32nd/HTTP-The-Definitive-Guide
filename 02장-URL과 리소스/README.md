# HTTP 완벽가이드 정리

## 2장 URL과 리소스

### 2.1 인터넷의 리소스 탐색하기

URL은 브라우저가 정보를 찾는데 필요한 **리소스의 위치**를 가리키며, URL을 이용해 사람과 애플리케이션이
리소스를 찾고 사용하며 공유한다.

URL은 URI의 부분집합이다. URI는 URL과 URN으로 구성된 종합적인 개념이다.

```
http://www.google.com/index.html
```

위의 URL은 아래와 같이 세 부분으로 나뉜다. (1장에서도 언급됨)

1. [http://] - URL의 스킴, 스킴은 웹 클라이언트가 리소스에 어떻게 접근하는지 알려준다. HTTP 프로토콜을 사용한다.
2. [www.google.com] - 서버의 위치다. 웹 클라이언트가 리소스가 어디에 호스팅 되어있는지 알려준다.
3. [/index.html] - /index.html은 리소스의 경로다.

URL은 HTTP 프로토콜이 아닌 다른 가용한 프로토콜을 사용할 수도 있다.

- mailto:abc@google.com
- ftp://ftp.books.com/pub/test.xls
- rtsp://www.google.com/image/5

이메일, 파일, 스트리밍 등 다양한 프로토콜을 이용하여 인터넷에 있는 어떤 리소스든지 가리킬 수 있다.

### 2.2 URL 문법

URL로 인터넷상의 모든 리소스를 찾을 수 있지만, 그 리소스들은 다른 스킴(HTTP, FTP, SMTP)을 통해 접근가능하며,
URL 문법은 스킴에 따라서 달라진다.

대부분의 URL 스킴의 문법은 일반적으로 9개 부분으로 나뉜다.

```
<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
```

이 모든 컴포넌트를 가지는 URL은 거의 없다. 가장 중요한 세 가지 컴포넌트는 **스킴, 호스트, 경로**다.

| 컴포넌트    | 설명                                                                                                                                                    | 기본값           |
| :---------- | :------------------------------------------------------------------------------------------------------------------------------------------------------ | :--------------- |
| **스킴**    | **리소스를 가져올 때 사용하는 프로토콜 정보**                                                                                                           | 없음             |
| 사용자 이름 | 몇몇 스킴은 리소스에 접근하기 위해 사용자 이름을 필요로 함                                                                                              | anonymous        |
| 비밀번호    | 사용자의 비밀번호를 가리키며, 사용자 이름에 콜론(:)으로 이어서 기술한다                                                                                 | <이메일 주소>    |
| **호스트**  | **리소스를 호스팅하는 서버의 호스트 명이나 IP**                                                                                                         | 없음             |
| 포트        | 리소스를 호스팅하는 서버가 열어놓은 포트번호                                                                                                            | 스킴에 따라 다름 |
| **경로**    | **이전 컴포넌트와 빗금(/)으로 구분되어 있으며, 서버 내 리소스가 어디에 있는지를 가리킨다. 경로 컴포넌트의 문법은 서버와 스킴에 따라 다르다**            | 없음             |
| 파라미터    | 특정 스킴들에서 입력 파라미터를 기술하는 용도로 사용한다. 이름/값을 쌍으로 가진다.                                                                      | 없음             |
| 질의        | 스킴에서 애플리케이션(데이터베이스, 게시판, 검색엔진, 기타 인터넷 게이트)에 파라미터를 전달하는데 쓰인다.                                               | 없음             |
| 프래그먼트  | 리소스의 조각이나 일부분을 가리키는 이름이다. URL이 특정 객체를 가리킬 경우에프래그먼트 필드는 서버에 전달되지 않는다.URL의 끝에서 "#" 문자로 구분한다. | 없음             |

#### 2.2.1 스킴: 사용할 프로토콜

스킴은 주어진 리소스에 **어떻게 접근**하는지 알려주는 중요한 정보다. 스킴명은 대소문자를 가리지 않는다.

#### 2.2.2 호스트와 포트

리소스를 호스팅하고 있는 장비와 그 장비 내에서 리소스에 접근할 수 있는 서버가 어디에 있는지 알아야 한다.
URL의 호스트와 포트 컴포넌트는 그 두 가지 정보를 제공한다.

#### 2.2.3 사용자 이름과 비밀번호

많은 서버는 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구한다.
FTP 서버가 좋은 예다.

```
ftp://ftp.prep.ai.mit.edu/pub/gnu
ftp://anonymous@ftp.prep.ai.mit.edu/pub/gnu
ftp://anonymous:my_passwd@ftp.prep.ai.mit.edu/pub/gnu
```

사용자 이름과 비밀번호를 기술하지 않고 FTP URL에 접근하면, 기본 사용자 이름 값으로 'anonymous'
비밀번호는 브라우저마다 가지고 있는 기본값을 사용한다.

#### 2.2.4 경로

URL의 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다. URL의 경로는 유닉스 파일 시스템의
파일 경로와 유사하다.

#### 2.2.5 파라미터

URL의 파라미터 컴포넌트는, 애플리케이션이 **서버에 정확한 요청**을 하기 위해 필요한 입력 파라미터를 받는데 사용한다.
이름/값 쌍의 리스트로 URL 나머지 부분들로부터 ';' 문자로 구분하여 URL에 기술한다.

```
http://www.google.com/image;name=cute
```

이 경우 이름은 'name'이고, 값은 'cute'인 name=cute라는 단 한 개의 파라미터를 전달한다.

HTTP URL에서 경로 컴포넌트는 경로조각으로 나눌 수 있다.
각 조각은 자체 파라미터를 가질 수 있다.

```
http://www.google.com/hammers;sale=false/inde.html;graphics=true
```

위 URL에는 hammers와 index.html 이라는 두 개의 경로조각이 있다.

hammers 경로 조각은 값이 false인 sale 파라미터를 가진다.
index.html 경로조각은 값이 true인 graphics란 파라미터를 가진다.

#### 2.2.6 질의 문자열

데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있다.
URL의 질의 컴포넌트는 게이트웨이를 가리키는 URL의 경로 컴포넌트와 함께 전달하고 있다.
게이트웨이는, 다른 애플리케이션에 접근하려고 할 때 거치는 통로라고 할 수 있다.

많은 게이트웨이가 '&'로 나뉘는 'key=value' 형식의 질의 문자열을 원한다.

#### 2.2.7 프래그먼트

HTML 같은 리소스 형식들은 본래의 수준보다 더 작게 나뉠 수 있다.
리소스의 특정 부분을 가리킬 수 있도록, URL은 리소스 내의 조각을 가리킬 수 있는 프래그먼트 컴포넌트를 제공한다.

```
http://google.com/tools.html/#drills
```

일반적으로 HTTP 서버는 객체 일부가 아닌 전체만 다루기 때문에, 클라이언트는 서버에 프래그먼트를 전달하지 않는다.
브라우저가 서버로부터 전체 리소스를 내려받은 후, 프래그먼트를 사용하여 당신이 보고자 하는 리소스의 일부를 보여준다.

### 2.3 단축 URL

#### 2.3.1 상대 URL

URL은 상대 URL과 절대 URL 두 가지로 나뉜다.

- 절대 URL : 리소스에 접근하는데 필요한 모든 정보를 가지고 있다.
- 상대 URL : URL을 짧게 표기하는 방식이다. 기저(base)라고 하는 다른 URL을 사용한다.

```html
<a href="./hammers.html">hammers</a>
```

위의 소스는 http://google.com/tools.html가 가리키는 리소스인 HTML 문서의 일부분이다.
**./hammers.html** URI를 가리키는 하이퍼링크가 있다.

구글 웹 서버의 /tools.html리소스를 기준으로 상대경로로 명시되어 있는 것이다.

상대 URL 문법에 따르면, URL의 스킴, 호스트 그리고 다른 컴포넌트 정보들은 해당 컴포넌트가 포함된
리소스의 **기저 URL**에서 알아낼 수 있다.

```
http://google.com/tools.html
```

이 URL을 기저 URL로 사용하여, 스킴, 호스트를 추측할 수 있다.

http 스킴과 google.com 호스트를 알아내어 다음과 같은 절대 URL을 알아낸다.

```
http://google.com/hammers.html
```

어떤 리소스들은 기저 URL을 명확하게 기술하기도 한다.
-> HTML 문서에서는 그 안에 있는 모든 상대 URL을 변경하기 위해서 기저 URL을 가리키는
**\<base\>** html 태그를 기술할 수 있다.

#### 2.3.2 URL 확장

URL 확장 기능은 두 가지로 나뉜다.

- 호스트 명 확장

  - google을 입력하면, 자동으로 'www.'와 '.com'을 붙여서 'www.google.com'을 만든다.

- 히스토리 확장
  - 과거에 사용자가 방문했던 URL의 기록을 저장한다.

## 2.4 안전하지 않은 문자

- URL은 잘 호환되도록 설계 되었다.
- URL은 인터넷에 있는 **모든 리소스가 여러 프로토콜을 통해서 전달될 수 있도록**, 각 리소스에 유일한 이름을 지을 수 있게 설계되었다.
- **안전한 전송이란 정보가 유실 위험 없이 URL을 전송할 수 있다**는 것을 의미한다.
- 전자메일에 사용되는 **SMTP**(Simple Mail Transfer Protocol)같은 프로토콜은 **특정 문자를 제거**할 수도 있는 전송 방식을 사용한다.
- 문자가 제거되는 일을 피하고자 **URL 설계자들은 상대적으로 작고 일반적으로 안전한 알파벳 문자만 포함하도록 허락한다.**
- URL 설계자들이 원한 것
  - 모든 인터넷 프로토콜로 URL이 전송 되는 것
  - 가독성이 있는 것. → 이 때문에 출력되지 않거나 보이지 않는 문자는 사용을 금지했다.
  - 안전하지 않은 문자를 안전한 문자로 인코딩 할 수 있도록 한 것. → 이스케이프 기능을 추가

### 2.4.1 URL 문자 집합

- 역사적으로 많은 컴퓨터 어플리케이션이 US-ASCII 문자 집합을 사용해왔다.
- US-ASCII는 문자를 서식화하고 하드웨어상에서 신호를 주고받기위해 7비트를 사용하며 영문 자판에 있는 키 대부분과 몇몇 출력되지 않는 제어문자를 표현한다.
- US-ASCII는 만들어진지 오래된 문자 집합이기 때문에 적은 수의 문자만을 포함하며 유럽 언어, 비 라틴계 언어들의 변형된 문자들까지 지원하진 않는다.
- URL이 특정 이진 데이터를 포함해야 하는 경우도 있는데 이런 것들을 지원하지 위해서 URL 설계자들은 URL에 이스케이프 문자열을 쓸 수 있게 설계하여 **이동성과 완성도를 높였다.**

### 2.4.2 인코딩 체계

- 안전한 문자 집합을 이용하는 경우 그 표현의 한계를 넘기 위해, URL에 있는 안전하지 않은 문자를 표현할 수 있는 인코딩 방식이 고안되었다.
- 인코딩은 안전하지 않은 문자를 % 로 시작해 ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 이스케이프 문자로 바꾼다.

![Untitled](https://user-images.githubusercontent.com/108210492/219380645-832189ee-d718-467f-8fc0-5edfc3938a03.png)

| 문자 | 이스케이프 문자 |
| ---- | --------------- |
| 공백 | %20             |
| $    | %24             |
| %    | %25             |
| &    | %26             |

### 2.4.3 문제 제한

- 몇몇 문자는 URL 내에서 특별한 의미로 예약되어있다.
- 어떤 문자는 US-ASCII의 출력 가능한 문자열 집합에 포함되어 있지 않다.
- 어떤 문자는 몇몇 인터넷 게이트웨이와 프로토콜에서 혼동되는 것으로 알려져있어서 사용이 꺼려지기도 한다.

아래 표는 URL에서 예약된 문자들을 본래의 목적이 아닌 다른 용도로 사용하려면 그전에 반드시 인코딩해야하는 문자들을 나열해 놓았다.

![Untitled (1)](https://user-images.githubusercontent.com/108210492/219380691-9e10a54c-d830-4034-9518-77343f62fe3f.png)

### 2.4.4. 좀 더 알아보기

- **애플리케이션은 정해진 방식대로 구현해야한다.**
- 어떤 애플리케이션에 어떤 URL을 보내든지, 그 전에 클라이언트 애플리케이션에서 안전하지 않거나 제한된 문자를 변환하는 것이 좋다.
- 안전하지 않은 모든 문자를 인코딩하기만 하면, 다른 애플리케이션을부터 특별한 의미를 갖는 문자를 받았을 때 혼동할 걱정 없이 애플리케이션 간에 공우할 수 있는 URL의 원형을 유지할 수 있다.
- **입력받은 URL에서 어떤 문자를 인코딩 해야하는 지를 결정하는 것은 최초로 URL을 입력받는 애플리케이션에서 하는 것이 가장 적절하다.**
- URL을 구성하는 각 컴포넌트마다 사용할 수 있거나 없는 문자들이 있을 것이고 또 어떤 문자는 **스킴에 따라서 가용성이 달라지기 때문에** 해당 문자열들을 직접 입력 받는 애플리케이션이야 말로 어떤 문자를 인코딩해야하는지 결정하기 가장 좋은 위치라는 것이다.
- 스킴과 같은 몇몇 URL 컴포넌트는 쉽게 알아볼 수 있어야 하며 알파벳 문자로 시작되어야한다.

## 2.5 스킴의 바다

![Untitled (2)](https://user-images.githubusercontent.com/108210492/219380672-c8291e04-85fb-4bed-966d-ca097663f90e.png)

![Untitled (3)](https://user-images.githubusercontent.com/108210492/219380677-696dd544-6766-4016-b358-7c53205d098f.png)

## 2.6 미래

- URL은 강력한 도구다, 세상에 존재하는 모든 객체에 이름을 지을 수 있고, 새로운 포맷을 쉽게 추가할 수 있게 설계됐다.
- URL은 주소이지 실제이름이 아니다. 리소스를 찾는데 필요한 포트와 서버이름을 제공하기 때문에 리소스가 옮겨지면 더이상 URL을 사용할 수 없다.
- 이런 문제를 예방하려면 그 객체의 위치와 상관없이 객체를 가리키는 실제 객체의 이름을 사용하는 것이다.
- 인터넷 기술 테스크 포스(Internet Engineering Task Force, IEFT)는 URN (Uniform Resource Names)라는 새로운 표준 작업에 착수하였다. URN은 항상 객체를 가리킬 수 있는 이름을 제공한다.
- **지속 통합 자원 지시자(Persistent uniform resource locators, PURL)**을 사용하면 URL로 URN의 기능을 제공할 수 있다.
  ![Untitled (4)](https://user-images.githubusercontent.com/108210492/219380686-48c78e65-3876-4836-b3fe-b1f6acad0f11.png)
  - PURL은 리소스의 실제 URL 목록을 관리하고 추적하는 리소스 위치 중개서버를 두고, 해당 리소스를 우회적으로 제공한다.
  - 클라이언트는 위치 할당자에게 리소스를 가져올 수 있는 영구적인 URL을 요청할 수 있으며, 영구적인 URL은 클라이언트를 리소스의 실제 URL로 연결해준다.

### 2.6.1 지금이 아니면, 언제?

- 한동안 URN 방식이 활용되었었다.
- URL에서 URN으로 주소 체계를 바꾸는 것은 아주 큰 작업이다. URN으로 전환하기 위한 모든 것이 준비되려면 시간이 걸리기 때문에, URL은 당분간 계속 사용될 것이다.

## 2.7 추가 정보

[https://www.w3.org/](https://www.w3.org/)
